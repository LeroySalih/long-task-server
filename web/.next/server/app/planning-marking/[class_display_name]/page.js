(()=>{var e={};e.id=684,e.ids=[684],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},35900:e=>{"use strict";e.exports=require("pg")},39491:e=>{"use strict";e.exports=require("assert")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},63477:e=>{"use strict";e.exports=require("querystring")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},12473:(e,s,a)=>{"use strict";a.r(s),a.d(s,{GlobalError:()=>i.a,__next_app__:()=>u,originalPathname:()=>b,pages:()=>o,routeModule:()=>p,tree:()=>l}),a(17928),a(46804),a(35954),a(35866);var t=a(23191),n=a(88716),r=a(37922),i=a.n(r),d=a(95231),c={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>d[e]);a.d(s,c);let l=["",{children:["planning-marking",{children:["[class_display_name]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,17928)),"/Users/leroysalih/Long-task-svr/web/app/planning-marking/[class_display_name]/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,46804)),"/Users/leroysalih/Long-task-svr/web/app/planning-marking/layout.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,57481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(a.bind(a,35954)),"/Users/leroysalih/Long-task-svr/web/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,57481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],o=["/Users/leroysalih/Long-task-svr/web/app/planning-marking/[class_display_name]/page.tsx"],b="/planning-marking/[class_display_name]/page",u={require:a,loadChunk:()=>Promise.resolve()},p=new t.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/planning-marking/[class_display_name]/page",pathname:"/planning-marking/[class_display_name]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},15550:(e,s,a)=>{let t={"037192152793ed3b7e340ccda21ed1724e7cdd94":()=>Promise.resolve().then(a.bind(a,33829)).then(e=>e.$$ACTION_3),"0a7068661e484452384eb20f440604a6316764df":()=>Promise.resolve().then(a.bind(a,33829)).then(e=>e.$$ACTION_6),"16c572eef18892eab1a5d8acc6522c239fcb10a9":()=>Promise.resolve().then(a.bind(a,33829)).then(e=>e.handleUpdateOutcomesByClassTag),"2163d60cc403d3219f51848724786a72aba90d75":()=>Promise.resolve().then(a.bind(a,33829)).then(e=>e.handleUpdateOutcomesByAssignmentID),"3a5b1a5d9fbb60b1992bcb8cd46480d42a3af5f5":()=>Promise.resolve().then(a.bind(a,33829)).then(e=>e.$$ACTION_1),"448558ba4655c1ce8d7db9818c076052b2b963f9":()=>Promise.resolve().then(a.bind(a,33829)).then(e=>e.handleUpdateClasses),"47717431253219e7183eb2e0f447a263857c3bc7":()=>Promise.resolve().then(a.bind(a,33829)).then(e=>e.handleUpdateAssignmentsByClassTag),"702e479893ff1a0030c209782e4598179af978d9":()=>Promise.resolve().then(a.bind(a,33829)).then(e=>e.handleUpdateUsers),"73bc6cba0891d96546ed3bdb4b50773c80496346":()=>Promise.resolve().then(a.bind(a,33829)).then(e=>e.$$ACTION_5),"91432a40184c84d5e0a3ef4751054b199ebb343a":()=>Promise.resolve().then(a.bind(a,33829)).then(e=>e.$$ACTION_0),"9bca5f5b243a12749829d79daa2ff2aa2f28c9e3":()=>Promise.resolve().then(a.bind(a,33829)).then(e=>e.handleUpdateAssignments),"9dc354239270f4d5a964c4a06edefa42082bd5fb":()=>Promise.resolve().then(a.bind(a,33829)).then(e=>e.handleUpdateOutcomes),b2101ea4f732d65420890053befe91739a824106:()=>Promise.resolve().then(a.bind(a,33829)).then(e=>e.$$ACTION_4),db363b088250387688b1bd1a81b055fec2fe7bc8:()=>Promise.resolve().then(a.bind(a,33829)).then(e=>e.$$ACTION_2)};async function n(e,...s){return(await t[e]()).apply(null,s)}e.exports={"037192152793ed3b7e340ccda21ed1724e7cdd94":n.bind(null,"037192152793ed3b7e340ccda21ed1724e7cdd94"),"0a7068661e484452384eb20f440604a6316764df":n.bind(null,"0a7068661e484452384eb20f440604a6316764df"),"16c572eef18892eab1a5d8acc6522c239fcb10a9":n.bind(null,"16c572eef18892eab1a5d8acc6522c239fcb10a9"),"2163d60cc403d3219f51848724786a72aba90d75":n.bind(null,"2163d60cc403d3219f51848724786a72aba90d75"),"3a5b1a5d9fbb60b1992bcb8cd46480d42a3af5f5":n.bind(null,"3a5b1a5d9fbb60b1992bcb8cd46480d42a3af5f5"),"448558ba4655c1ce8d7db9818c076052b2b963f9":n.bind(null,"448558ba4655c1ce8d7db9818c076052b2b963f9"),"47717431253219e7183eb2e0f447a263857c3bc7":n.bind(null,"47717431253219e7183eb2e0f447a263857c3bc7"),"702e479893ff1a0030c209782e4598179af978d9":n.bind(null,"702e479893ff1a0030c209782e4598179af978d9"),"73bc6cba0891d96546ed3bdb4b50773c80496346":n.bind(null,"73bc6cba0891d96546ed3bdb4b50773c80496346"),"91432a40184c84d5e0a3ef4751054b199ebb343a":n.bind(null,"91432a40184c84d5e0a3ef4751054b199ebb343a"),"9bca5f5b243a12749829d79daa2ff2aa2f28c9e3":n.bind(null,"9bca5f5b243a12749829d79daa2ff2aa2f28c9e3"),"9dc354239270f4d5a964c4a06edefa42082bd5fb":n.bind(null,"9dc354239270f4d5a964c4a06edefa42082bd5fb"),b2101ea4f732d65420890053befe91739a824106:n.bind(null,"b2101ea4f732d65420890053befe91739a824106"),db363b088250387688b1bd1a81b055fec2fe7bc8:n.bind(null,"db363b088250387688b1bd1a81b055fec2fe7bc8")}},94012:(e,s,a)=>{"use strict";a.d(s,{L:()=>t});let t={providers:[(0,a(27606).Z)({clientId:process.env.AZURE_AD_CLIENT_ID,clientSecret:process.env.AZURE_AD_CLIENT_SECRET,tenantId:process.env.AZURE_AD_TENANT_ID,authorization:{params:{scope:"openid profile user.Read email"}}})],secret:process.env.NEXTAUTH_SECRET,callbacks:{jwt:async({token:e,account:s})=>(s&&(e.idToken=s.id_token,e.accessToken=s.access_token),e),session:async({session:e,token:s})=>(e.accessToken=s.accessToken,e.idToken=s.idToken,e)}}},17928:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>o});var t=a(19510),n=a(29),r=a(71603),i=a(52359),d=a(61519),c=a(64616),l=a(33829);let o=async({params:e})=>{let{class_display_name:s}=e;s=decodeURIComponent(s);let a=(0,d.G)(r.ou.now()),o=a.minus({weeks:10}),u=a.plus({weeks:2}),{data:f,error:m}=await (0,i.N)(o,u),h=f?.filter(e=>e.class_display_name==s),g=h&&h.length>0&&(0,c.Z)(h[0]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.Z,{children:["Details for ",s]}),(0,t.jsxs)("form",{action:l.handleUpdateAssignmentsByClassTag,children:[t.jsx("input",{value:s,name:"classTag",type:"hidden"}),(0,t.jsxs)("button",{children:["Refresh Assignments for ",s]})]}),(0,t.jsxs)("form",{action:l.handleUpdateOutcomesByClassTag,children:[t.jsx("input",{value:s,name:"classTag",type:"hidden"}),(0,t.jsxs)("button",{children:["Refresh Marking for ",s]})]}),t.jsx(p,{checks:g}),t.jsx("div",{children:h&&void 0!==h[0]&&void 0!==h[0].assignments?"":t.jsx("div",{children:"No Data"})}),t.jsx("div",{children:h?.map((e,s)=>t.jsx("div",{children:e.assignments.sort((e,s)=>e.assignment.due_date_time>s.assignment.due_date_time?-1:1).map((e,s)=>t.jsx("div",{children:t.jsx(b,{assignmentDetails:e.assignment,outcomes:e.outcomes})},s))},s))})]})},b=({assignmentDetails:e,outcomes:s})=>{let{outcomeCount:a,notMarked:n,notCompleted:i}={outcomeCount:s.length,notMarked:s.filter(e=>null===e.points).length,notCompleted:s.filter(e=>0===e.points).length},c=r.ou.fromISO(e.due_date_time);return(0,d.G)(c),(0,d.Pv)(c),(0,t.jsxs)("div",{className:`border-solid border-slate-400 border-2 rounded-lg m-2 p-2 ${(e=>{if((0,d.YL)(e))return"bg-green-200/50"})(r.ou.fromISO(e.due_date_time))} text-slate-800`,children:[t.jsx("div",{children:e.display_name}),(0,t.jsxs)("div",{children:["Curr:   ",c.toISODate()]}),(0,t.jsxs)("div",{className:"flex text-xs align-middle",children:[t.jsx(u,{outcomeCount:a,notMarked:n,notCompleted:i}),(0,t.jsxs)("div",{className:"ml-2",children:["(",n," Not marked, ",i," Not completed)"]}),(0,t.jsxs)("form",{action:l.handleUpdateOutcomesByAssignmentID,children:[t.jsx("input",{value:e.assignment_id,name:"assignment_id",type:"hidden"}),t.jsx("button",{className:"ml-2",children:"Refresh"})]})]}),(0,t.jsxs)("details",{children:[t.jsx("summary",{children:"Details"}),s?.map((e,s)=>t.jsxs("p",{children:[e.givenname," ",e.surname," ",null==e.points?"not marked":e.points]},s))]})]})},u=({outcomeCount:e,notMarked:s,notCompleted:a})=>{let n=s/e*100,r=(e-s-a)/e*100;return t.jsx("div",{children:(0,t.jsxs)("svg",{width:"100",height:"30",xmlns:"http://www.w3.org/2000/svg",children:[t.jsx("defs",{children:t.jsx("clipPath",{id:"round-corner",children:t.jsx("rect",{x:"0",y:"0",width:"100",height:"20",rx:"5",ry:"5"})})}),t.jsx("rect",{x:"0",y:"0",width:n,height:"20",fill:"silver",clipPath:"url(#round-corner)"}),t.jsx("rect",{x:n,y:"0",width:r,height:"20",fill:"green",clipPath:"url(#round-corner)"}),t.jsx("rect",{x:n+r,y:"0",width:a/e*100,height:"20",fill:"red",clipPath:"url(#round-corner)"})]})})},p=({checks:e})=>void 0===e||!1===e?t.jsx(t.Fragment,{children:"No Alert Data Available"}):t.jsx(t.Fragment,{children:(0,t.jsxs)("div",{children:[t.jsx("div",{className:`${e.includes("hasNoAssignmentsInNextWeek")?"bg-red-500":"bg-slate-100"} `,children:"Next week not planned"}),t.jsx("div",{className:`${e.includes("hasNoAssignmentsInCurrentWeek")?"bg-red-500":"bg-slate-100"} `,children:"Current week not planned"}),t.jsx("div",{className:`${e.includes("hasUnmarkedInPrevWeek")?"bg-red-500":"bg-slate-100"}`,children:"Last week not marked"})]})})},33829:(e,s,a)=>{"use strict";a.r(s),a.d(s,{$$ACTION_0:()=>o,$$ACTION_1:()=>u,$$ACTION_2:()=>f,$$ACTION_3:()=>h,$$ACTION_4:()=>x,$$ACTION_5:()=>_,$$ACTION_6:()=>y,handleUpdateAssignments:()=>p,handleUpdateAssignmentsByClassTag:()=>m,handleUpdateClasses:()=>l,handleUpdateOutcomes:()=>j,handleUpdateOutcomesByAssignmentID:()=>g,handleUpdateOutcomesByClassTag:()=>v,handleUpdateUsers:()=>b});var t=a(24330);a(60166);var n=a(62368),r=a(45609),i=a(94012),d=a(40618);let c=async(e,s,a=null)=>{let t,r=null;try{if(!e||!s)throw Error("No token passed");n.connect("amqp://user:password@message",function(n,r){if(n)throw n;r.createChannel(function(n,r){if(n)throw n;var i="task_queue",d=JSON.stringify({task:e,payload:a,token:s});r.assertQueue(i,{durable:!0}),r.sendToQueue(i,Buffer.from(d)),console.info(" [x] Sent %s",d),t={status:"ok"}})})}catch(s){console.error("[ERROR!] postMessageToQueue",e,s.message),r=s}finally{return{data:t,error:r}}},l=(0,t.j)("91432a40184c84d5e0a3ef4751054b199ebb343a",o);async function o(){console.info("Updating Classes");let e=await (0,r.getServerSession)(i.L);c("update-classes",e?.accessToken)}let b=(0,t.j)("3a5b1a5d9fbb60b1992bcb8cd46480d42a3af5f5",u);async function u(){let e=await (0,r.getServerSession)(i.L);c("update-users",e?.accessToken)}let p=(0,t.j)("db363b088250387688b1bd1a81b055fec2fe7bc8",f);async function f(){let e=await (0,r.getServerSession)(i.L);c("update-assignments",e?.accessToken)}let m=(0,t.j)("037192152793ed3b7e340ccda21ed1724e7cdd94",h);async function h(e){let s=await (0,r.getServerSession)(i.L);c("update-assignments-class-tag",s?.accessToken,{classTag:e.get("classTag")})}let g=(0,t.j)("b2101ea4f732d65420890053befe91739a824106",x);async function x(e){let s=await (0,r.getServerSession)(i.L);c("update-outcomes-assignment-id",s?.accessToken,{assignment_id:e.get("assignment_id")})}let v=(0,t.j)("73bc6cba0891d96546ed3bdb4b50773c80496346",_);async function _(e){let s=await (0,r.getServerSession)(i.L);c("update-outcomes-class-tag",s?.accessToken,{classTag:e.get("classTag")})}let j=(0,t.j)("0a7068661e484452384eb20f440604a6316764df",y);async function y(){let e=await (0,r.getServerSession)(i.L);c("update-outcomes",e?.accessToken)}(0,d.h)([l,b,p,m,g,v,j]),(0,t.j)("448558ba4655c1ce8d7db9818c076052b2b963f9",l),(0,t.j)("702e479893ff1a0030c209782e4598179af978d9",b),(0,t.j)("9bca5f5b243a12749829d79daa2ff2aa2f28c9e3",p),(0,t.j)("47717431253219e7183eb2e0f447a263857c3bc7",m),(0,t.j)("2163d60cc403d3219f51848724786a72aba90d75",g),(0,t.j)("16c572eef18892eab1a5d8acc6522c239fcb10a9",v),(0,t.j)("9dc354239270f4d5a964c4a06edefa42082bd5fb",j)}};var s=require("../../../webpack-runtime.js");s.C(e);var a=e=>s(s.s=e),t=s.X(0,[948,836,729,621,92,775,603,595,867],()=>a(12473));module.exports=t})();